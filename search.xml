<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[vue入门——一个简易的记事本应用]]></title>
      <url>http://yoursite.com/2016/07/14/vue%E5%85%A5%E9%97%A8-%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84%E8%AE%B0%E4%BA%8B%E6%9C%AC%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>&#x65E9;&#x5728;vue&#x521A;&#x51FA;&#x6765;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x57FA;&#x672C;&#x4E0A;&#x5DF2;&#x7ECF;&#x628A;&#x5165;&#x95E8;&#x6559;&#x7A0B;&#x770B;&#x8FC7;&#x4E00;&#x904D;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x60F3;&#x5230;&#x5408;&#x9002;&#x7684;&#x9879;&#x76EE;&#x6765;&#x7EC3;&#x4E60;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x76F4;&#x5C31;&#x6401;&#x7F6E;&#x4E86;&#x3002;&#x76F4;&#x524D;&#x4E24;&#x5929;&#x505A;&#x65E5;&#x5386;&#x63D2;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5728;&#x9605;&#x8BFB;&#x65E5;&#x5386;&#x63D2;&#x4EF6;&#x6E90;&#x7801;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x73B0;&#x5176;&#x539F;&#x7406;&#x662F;&#x5C06;&#x6240;&#x6709;&#x8981;&#x5C55;&#x793A;&#x7684;&#x65E5;&#x671F;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x5B58;&#x5165;&#x6570;&#x7EC4;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6839;&#x636E;&#x6570;&#x7EC4;&#x751F;&#x6210;&#x5143;&#x7D20;&#x6DFB;&#x52A0;&#x5230;&#x9875;&#x9762;&#x53BB;&#xFF0C;&#x77AC;&#x95F4;&#x5C31;&#x60F3;&#x5230;&#x4E86;vue&#x7684;&#x53CC;&#x5411;&#x6570;&#x636E;&#x7ED1;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x51B3;&#x5B9A;&#x5728;&#x505A;&#x5B8C;&#x65E5;&#x5386;&#x63D2;&#x4EF6;&#x4E4B;&#x540E;&#xFF0C;&#x4FBF;&#x7528;&#x8BE5;&#x65E5;&#x5386;&#x63D2;&#x4EF6;&#x6765;&#x505A;&#x4E00;&#x4E2A;&#x7B80;&#x6613;&#x7684;&#x5355;&#x9875;&#x5E94;&#x7528;&#xFF0C;&#x4F5C;&#x4E3A;vue&#x7684;&#x5165;&#x95E8;&#x7EC3;&#x4E60;&#x3002;<br><a id="more"></a></p>
<h1 id="&#x521D;&#x59CB;&#x5316;vue&#x5E94;&#x7528;&#x7ED3;&#x6784;"><a href="#&#x521D;&#x59CB;&#x5316;vue&#x5E94;&#x7528;&#x7ED3;&#x6784;" class="headerlink" title="&#x521D;&#x59CB;&#x5316;vue&#x5E94;&#x7528;&#x7ED3;&#x6784;"></a>&#x521D;&#x59CB;&#x5316;vue&#x5E94;&#x7528;&#x7ED3;&#x6784;</h1><p>&#x672C;&#x6765;&#x4EE5;&#x4E3A;&#x8981;&#x81EA;&#x5DF1;&#x914D;&#x7F6E;webpack&#xFF0C;&#x4F46;&#x662F;&#x770B;&#x4E86;&#x4E00;&#x4E0B;vue&#x6559;&#x7A0B;&#xFF0C;&#x5B98;&#x65B9;&#x5DF2;&#x7ECF;&#x63D0;&#x4F9B;&#x4E86;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x6784;&#x5EFA;&#x5355;&#x9875;&#x5E94;&#x7528;&#xFF0C;&#x867D;&#x7136;&#x6709;&#x70B9;&#x5E9E;&#x5927;&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x56FE;&#x65B9;&#x4FBF;&#xFF0C;&#x5C31;&#x4E0D;&#x81EA;&#x5DF1;&#x5199;&#x914D;&#x7F6E;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x5F00;&#x547D;&#x4EE4;&#x884C;&#x6309;&#x6559;&#x7A0B;&#x8FD0;&#x884C;&#xFF1A;</p>
<blockquote>
<p># &#x5168;&#x5C40;&#x5B89;&#x88C5; vue-cli<br>$ npm install -g vue-cli<br># &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E; &#x201C;webpack&#x201D; &#x6A21;&#x677F;&#x7684;&#x65B0;&#x9879;&#x76EE;<br>$ vue init webpack my-project<br># &#x5B89;&#x88C5;&#x4F9D;&#x8D56;&#xFF0C;&#x8D70;&#x4F60;<br>$ cd my-project<br>$ npm install<br>$ npm run dev</p>
</blockquote>
<p>&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x8DD1;&#x5B8C;&#x4E4B;&#x540E;&#xFF0C;&#x6253;&#x5F00;localhost:8080&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E00;&#x4E2A;helloword&#x9875;&#x9762;&#xFF0C;&#x8BF4;&#x660E;&#x521D;&#x59CB;&#x5316;&#x6CA1;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#x3002;&#x67E5;&#x770B;&#x4E86;&#x4E00;&#x4E0B;&#x9879;&#x76EE;&#x6587;&#x4EF6;&#xFF0C;&#x4E3B;&#x8981;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x662F;app.vue&#x548C;hello.vue&#x4E24;&#x4E2A;&#x7EC4;&#x4EF6;&#xFF0C;&#x4E3A;&#x4E86;&#x7701;&#x4E8B;&#xFF0C;&#x6211;&#x51B3;&#x5B9A;&#x76F4;&#x63A5;&#x5728;hello.vue&#x4E0A;&#x8FDB;&#x884C;&#x5F00;&#x53D1;&#x3002;&#x5B8C;&#x6210;&#x540E;&#x6837;&#x5B50;&#x5982;&#x56FE;&#xFF1A;<br><img src="/2016/07/14/vue&#x5165;&#x95E8;-&#x4E00;&#x4E2A;&#x7B80;&#x6613;&#x7684;&#x8BB0;&#x4E8B;&#x672C;&#x5E94;&#x7528;/vue_notebook.png" alt="vue_noebook"><br>&#x5B8C;&#x6574;&#x7684;&#x5E94;&#x7528;&#x6E90;&#x7801;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; <a href="https://github.com/wangzhipeng404/calendar" target="_blank" rel="external">&#x6211;&#x7684;github</a> &#x67E5;&#x770B;</p>
<h1 id="&#x786E;&#x8BA4;&#x9700;&#x6C42;"><a href="#&#x786E;&#x8BA4;&#x9700;&#x6C42;" class="headerlink" title="&#x786E;&#x8BA4;&#x9700;&#x6C42;"></a>&#x786E;&#x8BA4;&#x9700;&#x6C42;</h1><p>&#x5728;&#x5F00;&#x59CB;&#x52A8;&#x624B;&#x4E4B;&#x524D;&#xFF0C;&#x6700;&#x91CD;&#x8981;&#x7684;&#x662F;&#x60F3;&#x6E05;&#x695A;&#x8981;&#x505A;&#x4EC0;&#x4E48;&#x3002;&#x5728;&#x4E4B;&#x524D;&#x5B66;&#x4E60;vue&#x7684;&#x6559;&#x7A0B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5370;&#x8C61;&#x6BD4;&#x8F83;&#x6DF1;&#x7684;&#x662F;&#x5B83;&#x7684;&#x6570;&#x636E;&#x7ED1;&#x5B9A;&#x548C;&#x8868;&#x5355;&#x63A7;&#x4EF6;&#x7ED1;&#x5B9A;&#xFF0C;&#x8FD8;&#x6709;&#x4E8B;&#x4EF6;&#x7ED1;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x51B3;&#x5B9A;&#x5728;&#x5E94;&#x7528;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x529F;&#x80FD;&#xFF0C;&#x9274;&#x4E8E;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x6709;&#x4E00;&#x4E2A;&#x65E5;&#x5386;&#x63D2;&#x4EF6;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x8868;&#x5355;&#x7ED1;&#x5B9A;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x6846;&#xFF0C;&#x548C;&#x4E00;&#x4E9B;&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x51B3;&#x5B9A;&#x505A;&#x4E00;&#x4E2A;&#x8BB0;&#x4E8B;&#x672C;&#x5E94;&#x7528;&#xFF0C;&#x6BCF;&#x70B9;&#x51FB;&#x4E00;&#x4E2A;&#x65E5;&#x671F;&#xFF0C;&#x53EF;&#x4EE5;&#x5C55;&#x793A;&#x548C;&#x7F16;&#x8F91;&#x8BE5;&#x65E5;&#x671F;&#x7684;&#x4E00;&#x4E9B;&#x5185;&#x5BB9;&#xFF0C;&#x5E76;&#x4FDD;&#x5B58;&#x5728;localstorage&#x4E2D;&#x3002;</p>
<h1 id="&#x6784;&#x5EFA;&#x65E5;&#x5386;"><a href="#&#x6784;&#x5EFA;&#x65E5;&#x5386;" class="headerlink" title="&#x6784;&#x5EFA;&#x65E5;&#x5386;"></a>&#x6784;&#x5EFA;&#x65E5;&#x5386;</h1><p>&#x9996;&#x5148;&#x662F;&#x8981;&#x5C06;&#x539F;&#x6765;&#x7684;&#x65E5;&#x5386;&#x63D2;&#x4EF6;&#x7528;vue&#x6784;&#x5EFA;&#x51FA;&#x6765;&#xFF0C;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x4E3B;&#x8981;&#x662F;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;month_arr&#x6570;&#x7EC4;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x5F53;&#x524D;&#x8981;&#x5C55;&#x793A;&#x7684;&#x65E5;&#x5386;&#x9762;&#x677F;&#x7684;&#x6240;&#x4EE5;&#x65E5;&#x671F;&#xFF0C;&#x7136;&#x540E;&#x7528;v-for&#x7ED1;&#x5B9A;&#x5230;&#x9875;&#x9762;&#x4E2D;&#x3002;&#x6240;&#x4EE5;&#x9996;&#x5148;&#x5F97;&#x5728;data&#x91CC;&#x6DFB;&#x52A0;month_arr&#x5B57;&#x6BB5;,&#x4F46;&#x7531;&#x4E8E;&#x521D;&#x59CB;&#x6570;&#x636E;&#x4E5F;&#x9700;&#x8981;&#x7ECF;&#x8FC7;&#x8BA1;&#x7B97;&#x5F97;&#x5230;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x4E4B;&#x524D;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x7684;&#x51FD;&#x6570;&#xFF1A;<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> monthPanel = <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> myDate = date || <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  <span class="keyword">var</span> year = myDate.getFullYear()</span><br><span class="line">  <span class="keyword">var</span> month = myDate.getMonth()</span><br><span class="line">  <span class="keyword">var</span> currentDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, <span class="number">0</span>).getDate()</span><br><span class="line">  <span class="keyword">var</span> preDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate()</span><br><span class="line">  <span class="keyword">var</span> firstDay = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">var</span> firstCell = firstDay.getDay() === <span class="number">0</span> ? <span class="number">6</span> : firstDay.getDay() - <span class="number">1</span></span><br><span class="line">  <span class="keyword">var</span> bottomCell = <span class="number">42</span> - currentDays - firstCell</span><br><span class="line">  <span class="keyword">var</span> preMonth = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> p = firstCell; p &gt; <span class="number">0</span>; p--) {</span><br><span class="line">    preMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, preDays - p + <span class="number">1</span>))</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">var</span> len = preMonth.length</span><br><span class="line">  <span class="keyword">var</span> currentMonth = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; currentDays; c++) {</span><br><span class="line">    currentMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month, c + <span class="number">1</span>))</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">var</span> nextMonth = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; bottomCell; n++) {</span><br><span class="line">    nextMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, n + <span class="number">1</span>))</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  preMonth = preMonth.concat(currentMonth, nextMonth)</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    date: preMonth,</span><br><span class="line">    preLen: len,</span><br><span class="line">    currentLen: currentMonth.length</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">let</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">let</span> currentYear = today.getFullYear()</span><br><span class="line"><span class="keyword">let</span> currentMoth = today.getMonth()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">    data () {</span><br><span class="line">      current_year: currentYear,</span><br><span class="line">      current_month: currentMoth,</span><br><span class="line">      week: [<span class="string">&apos;&#x4E00;&apos;</span>, <span class="string">&apos;&#x4E8C;&apos;</span>, <span class="string">&apos;&#x4E09;&apos;</span>, <span class="string">&apos;&#x56DB;&apos;</span>, <span class="string">&apos;&#x4E94;&apos;</span>, <span class="string">&apos;&#x516D;&apos;</span>, <span class="string">&apos;&#x65E5;&apos;</span>],</span><br><span class="line">      month_arr: monthPanel(today),</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#x5C06;&#x65E5;&#x5386;&#x6570;&#x636E;&#x7ED1;&#x5B9A;&#x5230;&#x9875;&#x9762;&#x4E0A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;calendar-wrap&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;calendar-header&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;pre-month&quot; v-on:click=&quot;pre_month&quot;&gt;&lt;&lt;/span&gt;</span><br><span class="line">        &lt;span&gt;{{current_year}}&#x5E74;{{current_month + 1}}&#x6708;&lt;/span&gt;</span><br><span class="line">        &lt;span class=&quot;next-month&quot; v-on:click=&quot;next_month&quot;&gt;&gt;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;calendar-body clearfix&quot;&gt;</span><br><span class="line">        &lt;div v-for=&quot;item in week&quot; class=&quot;cell-dom&quot;&gt;</span><br><span class="line">          {{item}}</span><br><span class="line">        &lt;/div &gt;</span><br><span class="line">        &lt;div v-for=&quot;day in month_arr.date&quot;  v-on:click=&quot;update_date(day)&quot;&gt;</span><br><span class="line">          &lt;div v-if=&quot;is_same_day(day)&quot; class=&quot;cell-dom current-date&quot;&gt;</span><br><span class="line">            &lt;span v-if=&quot;$index &lt; month_arr.preLen || $index &gt;= month_arr.preLen + month_arr.currentLen&quot; class=&quot;disable&quot;&gt;</span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            &lt;/span&gt;</span><br><span class="line">            &lt;span v-else&gt;</span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            &lt;/span&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div v-else class=&quot;cell-dom&quot;&gt;</span><br><span class="line">            &lt;span v-if=&quot;$index &lt; month_arr.preLen || $index &gt;= month_arr.preLen + month_arr.currentLen&quot; class=&quot;disable&quot;&gt;</span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            &lt;/span&gt;</span><br><span class="line">            &lt;span v-else&gt;</span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            &lt;/span&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div &gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD8;&#x505A;&#x4E86;&#x4E00;&#x4E0B;&#x4E0D;&#x662F;&#x672C;&#x610F;&#x7684;&#x65E5;&#x671F;&#x8FDB;&#x884C;&#x7F6E;&#x7070;&#xFF0C;&#x5F53;&#x524D;&#x5B9A;&#x4F4D;&#x65E5;&#x671F;&#x6DFB;&#x52A0;&#x4E86;&#x80CC;&#x666F;&#xFF0C;&#x5176;&#x4E2D;&#x5927;&#x91CF;&#x4F7F;&#x7528;&#x4E86;v-if&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x6CA1;&#x6709;&#x4ED4;&#x7EC6;&#x53BB;&#x4E86;&#x89E3;filter&#xFF0C;&#x7528;filter&#x5E94;&#x8BE5;&#x80FD;&#x66F4;&#x4F18;&#x96C5;&#x5427;&#xFF0C;&#x540E;&#x7EED;&#x597D;&#x597D;&#x7814;&#x7A76;&#x4E00;&#x4E0B;&#xFF0C;&#x6DFB;&#x52A0;&#x4E86;&#x4E0A;&#x4E00;&#x4E2A;&#x6708;&#x548C;&#x4E0B;&#x4E00;&#x4E2A;&#x6708;&#x7684;&#x6309;&#x94AE;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;v-on&#x6765;&#x7ED1;&#x5B9A;&#x4E8B;&#x4EF6;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5BF9;&#x6BCF;&#x4E2A;&#x65E5;&#x671F;&#x6DFB;&#x52A0;&#x4E86;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#xFF0C;&#x4F46;&#x6CA1;&#x6709;&#x8BB2;&#x4E8B;&#x4EF6;&#x4EE3;&#x7406;&#x5230;&#x7236;&#x7EA7;&#xFF0C;&#x540E;&#x7EED;&#x4F18;&#x5316;&#x7684;&#x65F6;&#x5019;&#x8BD5;&#x8BD5;&#x600E;&#x4E48;&#x4EE3;&#x7406;&#xFF0C;&#x5728;methods&#x4E2D;&#x6DFB;&#x52A0;&#x4E86;&#x5BF9;&#x5E94;&#x7684;&#x65B9;&#x6CD5;&#x3002;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">methods: {</span><br><span class="line">    update_month: function (date) {</span><br><span class="line">      this.month_arr = monthPanel(date)</span><br><span class="line">    },</span><br><span class="line">    update_date: function (date) {</span><br><span class="line">      let id = this.create_id(date)</span><br><span class="line">      this.current_date = date</span><br><span class="line">      this.current_note = this.notes[id]</span><br><span class="line">    },</span><br><span class="line">    next_month: function () {</span><br><span class="line">      console.log(this.current_month)</span><br><span class="line">      if (this.current_month === 12) {</span><br><span class="line">        this.current_year += 1</span><br><span class="line">        this.current_month = 0</span><br><span class="line">      } else {</span><br><span class="line">        this.current_month += 1</span><br><span class="line">      }</span><br><span class="line">      this.update_month(new Date(this.current_year, this.current_month, 1))</span><br><span class="line">    },</span><br><span class="line">    pre_month: function () {</span><br><span class="line">      if (this.current_month === 0) {</span><br><span class="line">        this.current_year -= 1</span><br><span class="line">        this.current_month = 11</span><br><span class="line">      } else {</span><br><span class="line">        this.current_month -= 1</span><br><span class="line">      }</span><br><span class="line">      this.update_month(new Date(this.current_year, this.current_month, 1))</span><br><span class="line">    },</span><br><span class="line">    is_same_day: function (date) {</span><br><span class="line">      return date.toDateString() === this.current_date.toDateString()</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h1 id="&#x6784;&#x5EFA;&#x8F93;&#x5165;&#x6846;&#x548C;&#x5185;&#x5BB9;&#x5C55;&#x793A;&#x533A;&#x57DF;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7ED1;&#x5B9A;"><a href="#&#x6784;&#x5EFA;&#x8F93;&#x5165;&#x6846;&#x548C;&#x5185;&#x5BB9;&#x5C55;&#x793A;&#x533A;&#x57DF;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7ED1;&#x5B9A;" class="headerlink" title="&#x6784;&#x5EFA;&#x8F93;&#x5165;&#x6846;&#x548C;&#x5185;&#x5BB9;&#x5C55;&#x793A;&#x533A;&#x57DF;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7ED1;&#x5B9A;"></a>&#x6784;&#x5EFA;&#x8F93;&#x5165;&#x6846;&#x548C;&#x5185;&#x5BB9;&#x5C55;&#x793A;&#x533A;&#x57DF;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7ED1;&#x5B9A;</h1><p>&#x6570;&#x636E;&#x7684;&#x50A8;&#x5B58;&#x7ED3;&#x6784;&#x7EE7;&#x7EED;&#x6309;&#x7167;&#x4E4B;&#x524D;&#x7684;&#x65E5;&#x671F;&#x751F;&#x6210;&#x552F;&#x4E00;id&#x6765;&#x8FDB;&#x884C;&#x5B58;&#x53D6;&#xFF0C;&#x6240;&#x4EE5;&#x9996;&#x5148;&#x5F97;&#x5C06;id&#x7684;&#x751F;&#x6210;&#x51FD;&#x6570;&#x642C;&#x8FC7;&#x6765;&#x3002;&#x7531;&#x4E8E;&#x4F7F;&#x7528;&#x7684;&#x662F;localstorage&#xFF0C;&#x6240;&#x4EE5;&#x9996;&#x5148;&#x8981;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x6709;note&#x6570;&#x636E;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5C31;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5F53;&#x5929;&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x6709;&#x6570;&#x636E;&#x4E86;&#xFF0C;&#x8FD8;&#x5FC5;&#x987B;&#x5C55;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> storage = <span class="built_in">window</span>.localStorage</span><br><span class="line"><span class="keyword">let</span> noteStorage = storage.getItem(<span class="string">&apos;notes&apos;</span>) ? <span class="built_in">JSON</span>.parse(storage.getItem(<span class="string">&apos;notes&apos;</span>)) : {}</span><br><span class="line"><span class="keyword">let</span> createId = <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">  <span class="keyword">let</span> y = date.getFullYear()</span><br><span class="line">  <span class="keyword">let</span> m = date.getMonth() + <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> d = date.getDate()</span><br><span class="line">  m = m &lt; <span class="number">10</span> ? <span class="string">&apos;0&apos;</span> + m : m</span><br><span class="line">  d = d &lt; <span class="number">10</span> ? <span class="string">&apos;0&apos;</span> + d : d</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&apos;date&apos;</span> + y + m + d</span><br><span class="line">}</span><br><span class="line"><span class="keyword">let</span> currentNote = noteStorage[currentId] ? noteStorage[currentId] : <span class="string">&apos;&apos;</span></span><br><span class="line">...</span><br><span class="line">data () {</span><br><span class="line">    ...</span><br><span class="line">    notes: noteStorage,</span><br><span class="line">    current_date: today,</span><br><span class="line">    current_note: currentNote</span><br><span class="line">    ... </span><br><span class="line">}</span><br><span class="line">...</span><br><span class="line">methods {</span><br><span class="line">    ...</span><br><span class="line">    update_note: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">      <span class="keyword">let</span> id = <span class="keyword">this</span>.create_id(<span class="keyword">this</span>.current_date)</span><br><span class="line">      <span class="keyword">this</span>.notes[id] = <span class="keyword">this</span>.current_note</span><br><span class="line">      storage.setItem(<span class="string">&apos;notes&apos;</span>, <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.notes))</span><br><span class="line">    },</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6A21;&#x677F;&#x4EE3;&#x7801;&#x4E3A;<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;note-wrap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note-input&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model</span>=<span class="string">&quot;current_note&quot;</span> <span class="attr">v-on:keyup</span>=<span class="string">&quot;update_note&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note-content&quot;</span>&gt;</span></span><br><span class="line">    {{current_note}}</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6DFB;&#x52A0;&#x4E86;notes&#x548C;current_notes&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#xFF0C;&#x548C;update_note&#x65B9;&#x6CD5;&#xFF0C;&#x672C;&#x6765;&#x60F3;&#x5728;&#x9875;&#x9762;&#x5173;&#x95ED;&#x65F6;&#x518D;&#x5C06;&#x6570;&#x636E;&#x50A8;&#x5B58;&#x8D77;&#x6765;&#xFF0C;&#x4F46;&#x662F;&#x5E76;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x4EC0;&#x4E48;&#x5F88;&#x597D;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x76D1;&#x542C;unload&#x4E8B;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x6682;&#x65F6;&#x5C31;&#x653E;&#x5728;keyup&#x4E2D;&#x5427;&#xFF0C;&#x8FD9;&#x6837;&#x80FD;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x4E0D;&#x4F1A;&#x4E22;&#x5931;&#x3002;</p>
<h1 id="&#x603B;&#x7ED3;&#x4E00;&#x4E0B;"><a href="#&#x603B;&#x7ED3;&#x4E00;&#x4E0B;" class="headerlink" title="&#x603B;&#x7ED3;&#x4E00;&#x4E0B;"></a>&#x603B;&#x7ED3;&#x4E00;&#x4E0B;</h1><p>&#x81F3;&#x6B64;&#xFF0C;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x8BB0;&#x4E8B;&#x672C;&#x5E94;&#x7528;&#x5C31;&#x505A;&#x5B8C;&#x4E86;&#xFF0C;&#x540E;&#x7EED;&#x9700;&#x8981;&#x4F18;&#x5316;&#x7684;&#x65B9;&#x9762;&#x4E3B;&#x8981;&#x6709;&#xFF1A;</p>
<ul>
<li>&#x4F18;&#x5316;&#x4E00;&#x4E0B;&#x6837;&#x5F0F;&#x548C;&#x90E8;&#x5C40;&#xFF0C;&#x5728;&#x505A;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x65F6;&#x5019;&#xFF0C;&#x4E3B;&#x8981;&#x8003;&#x8651;&#x529F;&#x80FD;&#x4E0A;&#x7684;&#x5B9E;&#x73B0;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5E76;&#x6CA1;&#x6709;&#x5728;&#x6837;&#x5F0F;&#x4E0A;&#x82B1;&#x4EC0;&#x4E48;&#x7CBE;&#x529B;&#xFF0C;&#x73B0;&#x5728;&#x770B;&#x8D77;&#x6765;&#x975E;&#x5E38;&#x7B80;&#x964B;&#xFF0C;&#x5177;&#x4F53;&#x600E;&#x4E48;&#x90E8;&#x5C40;&#x597D;&#x8FD8;&#x5F97;&#x7EE7;&#x7EED;&#x601D;&#x8003;&#x4E00;&#x4E0B;&#xFF1B;</li>
<li>&#x5C06;&#x7F16;&#x8F91;&#x5668;&#x66FF;&#x6362;&#x6210;markdown&#x6216;&#x8005;&#x5BCC;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF1B;</li>
<li>&#x7EE7;&#x7EED;&#x4E86;&#x89E3;vue&#x7684;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x7528;&#x6CD5;&#xFF0C;&#x6BD4;&#x5982;filter&#x548C;&#x4E8B;&#x4EF6;&#x4EE3;&#x7406;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x6162;&#x6162;&#x7684;&#x6DF1;&#x5165;&#x5B66;&#x4E60;&#x5427;&#x3002;<br>&#x672C;&#x6765;&#x4EE5;&#x4E3A;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5E94;&#x7528;&#x5F88;&#x5FEB;&#x5C31;&#x80FD;&#x5B8C;&#x6210;&#x4E86;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x65AD;&#x65AD;&#x7EED;&#x7EED;&#x5DEE;&#x4E0D;&#x591A;&#x82B1;&#x4E86;&#x4E24;&#x5929;&#xFF0C;&#x4E2D;&#x9014;&#x4E5F;&#x9047;&#x5230;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF1A;</li>
<li>&#x7531;&#x4E8E;&#x7B2C;&#x4E00;&#x6B21;&#x4F7F;&#x7528;eslint&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x5F00;&#x59CB;&#x8FD8;&#x6309;&#x7167;&#x4EE5;&#x524D;&#x7684;&#x4E60;&#x60EF;&#x5199;js&#xFF0C;&#x76F4;&#x63A5;&#x5C31;&#x62A5;&#x4E86;&#x4E00;&#x5927;&#x5806;&#x9519;&#x8BEF;&#xFF0C;&#x5BFC;&#x81F4;&#x61F5;&#x4E86;&#x5F88;&#x4E45;&#x624D;&#x53CD;&#x5E94;&#x8FC7;&#x6765;&#x3002;</li>
<li>&#x5728;&#x6DFB;&#x52A0;&#x4E86;&#x4E8B;&#x4EF6;&#x4E4B;&#x540E;&#x8FD0;&#x884C;&#x8001;&#x662F;&#x63D0;&#x793A; scope.next_month not a function,&#x4E0A;&#x7F51;&#x67E5;&#x4E86;&#x4E00;&#x4E0B;&#x4E5F;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x662F;&#x54EA;&#x91CC;&#x51FA;&#x9519;&#xFF0C;&#x540E;&#x6765;&#x91CD;&#x65B0;npm install&#x4E86;&#x4E00;&#x4E0B;&#x5374;&#x53C8;&#x80FD;&#x987A;&#x5229;&#x8FD0;&#x884C;&#x4E86;&#x3002;<br>&#x603B;&#x4E4B;&#x5728;&#x5B66;&#x4E60;vue&#x7684;&#x9053;&#x8DEF;&#x4E0A;&#x7EC8;&#x4E8E;&#x8FC8;&#x51FA;&#x4E86;&#x7B2C;&#x4E00;&#x6B65;&#x2026;</li>
</ul>
<h1 id="&#x5B8C;&#x6574;&#x7684;&#x7EC4;&#x4EF6;&#x4EE3;&#x7801;"><a href="#&#x5B8C;&#x6574;&#x7684;&#x7EC4;&#x4EF6;&#x4EE3;&#x7801;" class="headerlink" title="&#x5B8C;&#x6574;&#x7684;&#x7EC4;&#x4EF6;&#x4EE3;&#x7801;"></a>&#x5B8C;&#x6574;&#x7684;&#x7EC4;&#x4EF6;&#x4EE3;&#x7801;</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container clearfix&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;calendar-wrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;calendar-header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pre-month&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;pre_month&quot;</span>&gt;</span><span class="tag">&lt;&lt;/<span class="attr">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>{{current_year}}&#x5E74;{{current_month + 1}}&#x6708;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;next-month&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;next_month&quot;</span>&gt;</span>&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;calendar-body clearfix&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;item in week&quot;</span> <span class="attr">class</span>=<span class="string">&quot;cell-dom&quot;</span>&gt;</span></span><br><span class="line">          {{item}}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;day in month_arr.date&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;update_date(day)&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;is_same_day(day)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;cell-dom current-date&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;$index &lt; month_arr.preLen || $index &gt;= month_arr.preLen + month_arr.currentLen&quot;</span> <span class="attr">class</span>=<span class="string">&quot;disable&quot;</span>&gt;</span></span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;cell-dom&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;$index &lt; month_arr.preLen || $index &gt;= month_arr.preLen + month_arr.currentLen&quot;</span> <span class="attr">class</span>=<span class="string">&quot;disable&quot;</span>&gt;</span></span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">              {{day.getDate()}}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;note-wrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note-input&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model</span>=<span class="string">&quot;current_note&quot;</span> <span class="attr">v-on:keyup</span>=<span class="string">&quot;update_note&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note-content&quot;</span>&gt;</span></span><br><span class="line">        {{current_note}}</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line"><span class="keyword">let</span> storage = <span class="built_in">window</span>.localStorage</span><br><span class="line"><span class="keyword">let</span> noteStorage = storage.getItem(<span class="string">&apos;notes&apos;</span>) ? <span class="built_in">JSON</span>.parse(storage.getItem(<span class="string">&apos;notes&apos;</span>)) : {}</span><br><span class="line"><span class="keyword">let</span> monthPanel = <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> myDate = date || <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  <span class="keyword">var</span> year = myDate.getFullYear()</span><br><span class="line">  <span class="keyword">var</span> month = myDate.getMonth()</span><br><span class="line">  <span class="keyword">var</span> currentDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, <span class="number">0</span>).getDate()</span><br><span class="line">  <span class="keyword">var</span> preDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate()</span><br><span class="line">  <span class="keyword">var</span> firstDay = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">var</span> firstCell = firstDay.getDay() === <span class="number">0</span> ? <span class="number">6</span> : firstDay.getDay() - <span class="number">1</span></span><br><span class="line">  <span class="keyword">var</span> bottomCell = <span class="number">42</span> - currentDays - firstCell</span><br><span class="line">  <span class="keyword">var</span> preMonth = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> p = firstCell; p &gt; <span class="number">0</span>; p--) {</span><br><span class="line">    preMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, preDays - p + <span class="number">1</span>))</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">var</span> len = preMonth.length</span><br><span class="line">  <span class="keyword">var</span> currentMonth = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; currentDays; c++) {</span><br><span class="line">    currentMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month, c + <span class="number">1</span>))</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">var</span> nextMonth = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; bottomCell; n++) {</span><br><span class="line">    nextMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, n + <span class="number">1</span>))</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  preMonth = preMonth.concat(currentMonth, nextMonth)</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    date: preMonth,</span><br><span class="line">    preLen: len,</span><br><span class="line">    currentLen: currentMonth.length</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> createId = <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">  <span class="keyword">let</span> y = date.getFullYear()</span><br><span class="line">  <span class="keyword">let</span> m = date.getMonth() + <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> d = date.getDate()</span><br><span class="line">  m = m &lt; <span class="number">10</span> ? <span class="string">&apos;0&apos;</span> + m : m</span><br><span class="line">  d = d &lt; <span class="number">10</span> ? <span class="string">&apos;0&apos;</span> + d : d</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&apos;date&apos;</span> + y + m + d</span><br><span class="line">}</span><br><span class="line"><span class="keyword">let</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">let</span> currentYear = today.getFullYear()</span><br><span class="line"><span class="keyword">let</span> currentMoth = today.getMonth()</span><br><span class="line"><span class="keyword">let</span> currentId = createId(today)</span><br><span class="line"><span class="keyword">let</span> currentNote = noteStorage[currentId] ? noteStorage[currentId] : <span class="string">&apos;&apos;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  data () {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      current_year: currentYear,</span><br><span class="line">      current_month: currentMoth,</span><br><span class="line">      week: [<span class="string">&apos;&#x4E00;&apos;</span>, <span class="string">&apos;&#x4E8C;&apos;</span>, <span class="string">&apos;&#x4E09;&apos;</span>, <span class="string">&apos;&#x56DB;&apos;</span>, <span class="string">&apos;&#x4E94;&apos;</span>, <span class="string">&apos;&#x516D;&apos;</span>, <span class="string">&apos;&#x65E5;&apos;</span>],</span><br><span class="line">      month_arr: monthPanel(today),</span><br><span class="line">      notes: noteStorage,</span><br><span class="line">      current_date: today,</span><br><span class="line">      current_id: currentId,</span><br><span class="line">      current_note: currentNote</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    create_id: createId,</span><br><span class="line">    update_month: <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">      <span class="keyword">this</span>.month_arr = monthPanel(date)</span><br><span class="line">    },</span><br><span class="line">    update_date: <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">      <span class="keyword">let</span> id = <span class="keyword">this</span>.create_id(date)</span><br><span class="line">      <span class="keyword">this</span>.current_date = date</span><br><span class="line">      <span class="keyword">this</span>.current_note = <span class="keyword">this</span>.notes[id]</span><br><span class="line">    },</span><br><span class="line">    update_note: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">      <span class="keyword">let</span> id = <span class="keyword">this</span>.create_id(<span class="keyword">this</span>.current_date)</span><br><span class="line">      <span class="keyword">this</span>.notes[id] = <span class="keyword">this</span>.current_note</span><br><span class="line">      storage.setItem(<span class="string">&apos;notes&apos;</span>, <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.notes))</span><br><span class="line">    },</span><br><span class="line">    next_month: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.current_month)</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.current_month === <span class="number">12</span>) {</span><br><span class="line">        <span class="keyword">this</span>.current_year += <span class="number">1</span></span><br><span class="line">        <span class="keyword">this</span>.current_month = <span class="number">0</span></span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">this</span>.current_month += <span class="number">1</span></span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">this</span>.update_month(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">this</span>.current_year, <span class="keyword">this</span>.current_month, <span class="number">1</span>))</span><br><span class="line">    },</span><br><span class="line">    pre_month: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.current_month === <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">this</span>.current_year -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">this</span>.current_month = <span class="number">11</span></span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">this</span>.current_month -= <span class="number">1</span></span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">this</span>.update_month(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">this</span>.current_year, <span class="keyword">this</span>.current_month, <span class="number">1</span>))</span><br><span class="line">    },</span><br><span class="line">    is_same_day: <span class="function"><span class="keyword">function</span> (<span class="params">date</span>) </span>{</span><br><span class="line">      <span class="keyword">return</span> date.toDateString() === <span class="keyword">this</span>.current_date.toDateString()</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Add &quot;scoped&quot; attribute to limit CSS to this component only --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="undefined"></span><br><span class="line">.clearfix:befor,</span><br><span class="line">.clearfix:after {</span><br><span class="line">  clear: both;</span><br><span class="line">  content: &apos;&apos;;</span><br><span class="line">}</span><br><span class="line">.current-date {</span><br><span class="line">  background-color: #42b983;</span><br><span class="line">}</span><br><span class="line">.disable {</span><br><span class="line">  color: #BFBFBF;</span><br><span class="line">}</span><br><span class="line">.container {</span><br><span class="line">  width: 80%;</span><br><span class="line">  height: 100%;</span><br><span class="line">  margin-top: 50px;</span><br><span class="line">  margin-left: auto;</span><br><span class="line">  margin-right: auto;</span><br><span class="line">}</span><br><span class="line">#calendar-wrap, #note-wrap {</span><br><span class="line">  float: left;</span><br><span class="line">  position: relative;</span><br><span class="line">}</span><br><span class="line">#calendar-wrap {</span><br><span class="line">  width: 30%;</span><br><span class="line">}</span><br><span class="line">#note-wrap {</span><br><span class="line">  width: 60%;</span><br><span class="line">  height: 100%;</span><br><span class="line">}</span><br><span class="line">.pre-month, .next-month {</span><br><span class="line">  padding: 5px;</span><br><span class="line">}</span><br><span class="line">.cell-dom {</span><br><span class="line">  width: 14%;</span><br><span class="line">  float: left;</span><br><span class="line">  padding:15px 0;</span><br><span class="line">  border-bottom: 1px solid #ccc;</span><br><span class="line">}</span><br><span class="line">#note-wrap textarea, #note-wrap .note-content {</span><br><span class="line">  width: 45%;</span><br><span class="line">  min-height: 360px;</span><br><span class="line">  display: block;</span><br><span class="line">  float: left;</span><br><span class="line">  text-align: left;</span><br><span class="line">}</span><br><span class="line">#note-wrap .note-content {</span><br><span class="line">  margin-left: 5%;</span><br><span class="line">  border-left: 1px solid #ccc;</span><br><span class="line">  border-right: 1px solid #ccc;</span><br><span class="line">}</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[一个酒店预定日历插件]]></title>
      <url>http://yoursite.com/2016/07/11/%E4%B8%80%E4%B8%AA%E9%85%92%E5%BA%97%E9%A2%84%E5%AE%9A%E6%97%A5%E5%8E%86%E6%8F%92%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>由于新加入一个的公司是一个旅游公司，所以会涉及到酒店预订，但是随便搜索了一下，网上没找到适合的日历插件，而现在时间也比较多，便考虑自己实现一个，顺便提高一下自己的js水平。<br><a id="more"></a></p>
<h1 id="确定需求"><a href="#确定需求" class="headerlink" title="确定需求"></a>确定需求</h1><p>酒店预订的插件主要功能有下面两几点：</p>
<ul>
<li>从服务器获取日历信息并展示；</li>
<li>可以选择入住时间和离开时间；</li>
<li>选中的日期使用特殊的样式进行展示；</li>
<li>能够获取选中的时间段信息。<br>但是以上只是前台预订的功能，而我的构想是这个插件可以前后台通用，所以还得加上后台设置的功能，通过创建时参数的设定来确定是前台使用，还是后台设置数据。<br>后台设置的需求有：</li>
<li>从服务器获取日历信息并展示；</li>
<li>能够通过点击日期来设定或者修改当日的信息；</li>
<li>能够获取到设置好的数据储存或者传递到服务器；<br>需求确定了就可以开始动手了做了。</li>
</ul>
<h1 id="构建一个日历面板"><a href="#构建一个日历面板" class="headerlink" title="构建一个日历面板"></a>构建一个日历面板</h1><p>作为一个日历插件，最基础的部分当然是实现一个日历面板，然后再给日历上的每一天加上相应的点击事件，对于一个从来没有写过日历插件的我来说，能想到的当然是搜索一下js如何实现一个日历插件，然后发现已经大神实现了完整的日历面板，<a href="http://www.cnphp6.com/archives/38454" target="_blank" rel="external">javascript动手写日历组件</a>,基本上满足我所需要的功能，所以就不重复造轮子了，接下来就是在其基础上加以修改，将前后台的事件逻辑添加进去，实现我所需要的功能。原作者的完整源码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line">+------------------------------</span><br><span class="line">@author:vczero</span><br><span class="line">@time:2014/8/10</span><br><span class="line">@desc:简易日历组件</span><br><span class="line">+------------------------------</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">var</span> Calendar = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> Calendar = <span class="function"><span class="keyword">function</span>(<span class="params">div, date</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.div = <span class="built_in">document</span>.getElementById(div);</span><br><span class="line">        <span class="keyword">var</span> w = <span class="keyword">this</span>.div.style.width || <span class="number">390</span>;</span><br><span class="line">        <span class="keyword">var</span> h = <span class="keyword">this</span>.div.style.height || (<span class="number">300</span> - <span class="number">30</span>);</span><br><span class="line">        <span class="keyword">this</span>.width = <span class="built_in">parseInt</span>(w) &gt;= <span class="number">360</span> ? w : <span class="number">360</span>; </span><br><span class="line">        <span class="keyword">this</span>.height = <span class="built_in">parseInt</span>(h) &gt;= <span class="number">180</span> ? h : <span class="number">180</span>;</span><br><span class="line">        <span class="keyword">this</span>.date = date;</span><br><span class="line">        <span class="keyword">this</span>.div.style.width = <span class="keyword">this</span>.width + <span class="string">'px'</span>; <span class="comment">//按默认值设置回去</span></span><br><span class="line">        <span class="keyword">this</span>.div.style.height = <span class="keyword">this</span>.height + <span class="string">'px'</span>;<span class="comment">//按默认值设置回去</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Calendar.week = [<span class="string">'星期一'</span>, <span class="string">'星期二'</span>,<span class="string">'星期三'</span>, <span class="string">'星期四'</span>,<span class="string">'星期五'</span>, <span class="string">'星期六'</span>, <span class="string">'星期日'</span>];</span><br><span class="line"></span><br><span class="line">    Calendar.prototype[<span class="string">'showUI'</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> exist = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_celldom_0'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!!exist)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> e = <span class="number">0</span>; e &lt; <span class="number">42</span>; e++)&#123;</span><br><span class="line">                <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_celldom_'</span> + e);</span><br><span class="line">                node.onclick = <span class="literal">null</span>; <span class="comment">//移除事件处理程序</span></span><br><span class="line">                <span class="keyword">this</span>.div.removeChild(node);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> width = <span class="keyword">this</span>.width,</span><br><span class="line">            height = <span class="keyword">this</span>.height,</span><br><span class="line">            cell = &#123;width: (<span class="built_in">parseInt</span>(width) - <span class="number">20</span>)/<span class="number">7</span>, height: (<span class="built_in">parseInt</span>(height) <span class="number">-30</span> - <span class="number">20</span>)/<span class="number">6</span>&#125;,</span><br><span class="line">            monthArr = <span class="keyword">this</span>._monthPanel(<span class="keyword">this</span>.date);</span><br><span class="line">        <span class="keyword">this</span>.div.style.paddingLeft = <span class="string">'8px'</span>; </span><br><span class="line">        <span class="keyword">this</span>.div.style.border = <span class="string">'2px solid #57ABFF'</span>;</span><br><span class="line">        <span class="keyword">this</span>.div.style.cursor = <span class="string">'default'</span>;</span><br><span class="line">        <span class="keyword">this</span>.div.style.fontFamily = <span class="string">'微软雅黑'</span>;</span><br><span class="line">        <span class="keyword">this</span>._addHeader();</span><br><span class="line">        <span class="keyword">this</span>._addWeekday();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">var</span> cellDOM = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            cellDOM.style.width = cell.width + <span class="string">'px'</span>;</span><br><span class="line">            cellDOM.style.height = cell.height + <span class="string">'px'</span>;</span><br><span class="line">            cellDOM.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">            cellDOM.style.cssFloat = <span class="string">'left'</span>;</span><br><span class="line">            cellDOM.style.cursor = <span class="string">'pointer'</span>;</span><br><span class="line">            cellDOM.style.textAlign = <span class="string">'center'</span>;</span><br><span class="line">            cellDOM.id = <span class="string">'vczero_celldom_'</span> + i;</span><br><span class="line">            cellDOM.style.lineHeight = cell.height + <span class="string">'px'</span>;</span><br><span class="line">            cellDOM.setAttribute(<span class="string">'date'</span>,monthArr.date[i]); <span class="comment">//设置日期对象到DOM属性date上</span></span><br><span class="line">            cellDOM.innerHTML = monthArr.date[i].getDate();</span><br><span class="line">            <span class="comment">//去掉最后一行横线</span></span><br><span class="line">            <span class="keyword">if</span>(i &lt; <span class="number">35</span>)&#123;</span><br><span class="line">                cellDOM.style.borderBottom = <span class="string">'1px solid #C8CACC'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(i &lt; monthArr.preLen || i &gt;= monthArr.currentLen + monthArr.preLen)&#123;</span><br><span class="line">                cellDOM.style.color = <span class="string">'#BFBFBF'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.div.appendChild(cellDOM);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用父元素事件委托</span></span><br><span class="line">        <span class="keyword">this</span>.div.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> node = e.target;</span><br><span class="line">            <span class="keyword">if</span>(node.id.indexOf(<span class="string">'vczero_celldom_'</span>) &gt; <span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(node.getAttribute(<span class="string">'date'</span>)).toLocaleString();</span><br><span class="line">                callback(date);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Calendar.prototype._addHeader = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> exist = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_datediv'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!!exist)&#123;</span><br><span class="line">            exist.onclick = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.div.removeChild(exist);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> header = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        header.style.height = <span class="string">'22px'</span>;</span><br><span class="line">        header.style.width = <span class="keyword">this</span>.div.style.width || <span class="string">'800px'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//包含左 时间 右的大DIV</span></span><br><span class="line">        <span class="keyword">var</span> dateDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        dateDiv.style.width = <span class="string">'200px'</span>;</span><br><span class="line">        dateDiv.style.height = <span class="string">'22px'</span>;</span><br><span class="line">        dateDiv.style.margin = <span class="string">'0 auto'</span>;</span><br><span class="line">        dateDiv.style.textAlign = <span class="string">'center'</span>;</span><br><span class="line">        dateDiv.style.fontWeight = <span class="string">'bold'</span>;</span><br><span class="line">        dateDiv.id = <span class="string">'vczero_datediv'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&lt; DIV</span></span><br><span class="line">        <span class="keyword">var</span> leftDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        leftDiv.innerHTML = <span class="string">'&lt;'</span>;</span><br><span class="line">        leftDiv.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">        leftDiv.style.float = <span class="string">'left'</span>;</span><br><span class="line">        leftDiv.style.width = <span class="string">'50px'</span>;</span><br><span class="line">        leftDiv.style.cursor = <span class="string">'pointer'</span>;</span><br><span class="line">        leftDiv.style.color = <span class="string">'#C5BFBF'</span>;</span><br><span class="line">        <span class="keyword">var</span> _that = <span class="keyword">this</span>; <span class="comment">//获取到this对象</span></span><br><span class="line">        leftDiv.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> year = <span class="built_in">parseInt</span>(_that.date.getFullYear()),</span><br><span class="line">                month = <span class="built_in">parseInt</span>(_that.date.getMonth());</span><br><span class="line">            <span class="keyword">if</span>(month === <span class="number">0</span>)&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year - <span class="number">1</span>, <span class="number">11</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            _that[<span class="string">'showUI'</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&gt; DIV</span></span><br><span class="line">        <span class="keyword">var</span> rightDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        rightDiv.innerHTML = <span class="string">'&gt;'</span>;</span><br><span class="line">        rightDiv.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">        rightDiv.style.float = <span class="string">'left'</span>;</span><br><span class="line">        rightDiv.style.width = <span class="string">'50px'</span>;</span><br><span class="line">        rightDiv.style.cursor = <span class="string">'pointer'</span>;</span><br><span class="line">        rightDiv.style.color = <span class="string">'#C5BFBF'</span>;</span><br><span class="line">        rightDiv.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> year = <span class="built_in">parseInt</span>(_that.date.getFullYear()),</span><br><span class="line">                month = <span class="built_in">parseInt</span>(_that.date.getMonth());</span><br><span class="line">            <span class="keyword">if</span>(month === <span class="number">11</span>)&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year + <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            _that[<span class="string">'showUI'</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//显示月份的DIV</span></span><br><span class="line">        <span class="keyword">var</span> timeDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        timeDiv.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">        timeDiv.style.float = <span class="string">'left'</span>;</span><br><span class="line">        timeDiv.style.width = <span class="string">'100px'</span>;</span><br><span class="line">        timeDiv.innerHTML = <span class="keyword">this</span>.date.getFullYear() + <span class="string">'年'</span> + (<span class="keyword">this</span>.date.getMonth() + <span class="number">1</span>) + <span class="string">'月'</span>;</span><br><span class="line"></span><br><span class="line">        dateDiv.appendChild(leftDiv);</span><br><span class="line">        dateDiv.appendChild(timeDiv);</span><br><span class="line">        dateDiv.appendChild(rightDiv);</span><br><span class="line">        <span class="keyword">this</span>.div.appendChild(dateDiv);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//增加星期</span></span><br><span class="line">    Calendar.prototype._addWeekday = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> exist = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_week_0'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!!exist)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_week_'</span> + i);</span><br><span class="line">                node.onclick = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.div.removeChild(node);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; <span class="number">7</span>; n++)&#123;</span><br><span class="line">            <span class="keyword">var</span> weekday = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            weekday.style.width = (<span class="built_in">parseInt</span>(<span class="keyword">this</span>.width) - <span class="number">20</span>)/<span class="number">7</span> + <span class="string">'px'</span>;</span><br><span class="line">            weekday.style.height = <span class="string">'20px'</span>;</span><br><span class="line">            weekday.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">            weekday.style.float = <span class="string">'left'</span>;</span><br><span class="line">            weekday.style.color = <span class="string">'#BFBFBF'</span>;</span><br><span class="line">            weekday.style.fontWeight = <span class="string">'bold'</span>;</span><br><span class="line">            weekday.style.textAlign = <span class="string">'center'</span>;</span><br><span class="line">            weekday.id = <span class="string">'vczero_week_'</span> + n;</span><br><span class="line">            weekday.innerHTML = Calendar.week[n];</span><br><span class="line">            <span class="keyword">this</span>.div.appendChild(weekday);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Calendar.prototype._monthPanel = <span class="function"><span class="keyword">function</span>(<span class="params">date</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//如果传递了Date对象，则按Date对象进行计算月份面板</span></span><br><span class="line">        <span class="comment">//否则，按照当前月份计算面板</span></span><br><span class="line">        <span class="keyword">var</span> myDate = date || <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">            year = myDate.getFullYear(),</span><br><span class="line">            month = myDate.getMonth(),</span><br><span class="line">            day = myDate.getDate(),</span><br><span class="line">            week = myDate.getDay(),</span><br><span class="line">            currentDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, <span class="number">0</span>).getDate(),</span><br><span class="line">            preDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate(),</span><br><span class="line">            firstDay = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">1</span>),</span><br><span class="line">            firstCell = firstDay.getDay() === <span class="number">0</span> ? <span class="number">6</span> : firstDay.getDay() - <span class="number">1</span>,</span><br><span class="line">            bottomCell =  <span class="number">42</span> - currentDays - firstCell;</span><br><span class="line">        <span class="comment">//前一个月该显示多少天</span></span><br><span class="line">        <span class="keyword">var</span> preMonth = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> p = firstCell; p &gt; <span class="number">0</span>; p--)&#123;</span><br><span class="line">            preMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, preDays - p + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> len = preMonth.length;</span><br><span class="line">        <span class="comment">//本月</span></span><br><span class="line">        <span class="keyword">var</span> currentMonth = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; currentDays; c++)&#123;</span><br><span class="line">            currentMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month, c + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//下一个月</span></span><br><span class="line">        <span class="keyword">var</span> nextMonth = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; bottomCell; n++)&#123;</span><br><span class="line">            nextMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, n + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        preMonth = preMonth.concat(currentMonth, nextMonth);</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            date: preMonth,</span><br><span class="line">            preLen: len,</span><br><span class="line">            currentLen: currentMonth.length</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Calendar;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure></p>
<p>使用方式原作者的博客也有说明了，主要是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="keyword">new</span> Calendar(<span class="string">'calendar'</span>,<span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">c.showUI(<span class="function"><span class="keyword">function</span>(<span class="params">date</span>)</span>&#123;</span><br><span class="line">    alert(date);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>在研究了一下完整的源码之后，发现要实现我所需要的功能，得做以下修改：</p>
<ul>
<li>在调用插件时，增加一些配置参数，除了传入date之外，还需要传入一个包含需要展示在日期上的信息json，点击事件的回调函数以及使用场景是后台还是前台，将传入的变量储存起来以便后续使用；</li>
<li>修改showUI函数将信息展示出来；</li>
<li>为了在对应的日期上展示相应日期的信息，所以日期信息需要一个根据日期生成的唯一id；</li>
<li>如果是在后台使用，增加一个可以输入信息的模态框，并可以将输入的信息储存起来；</li>
<li>设置完之后，提供一个获取日期信息的接口。</li>
</ul>
<h1 id="增加创建时传入的参数"><a href="#增加创建时传入的参数" class="headerlink" title="增加创建时传入的参数"></a>增加创建时传入的参数</h1><p>由于除了传入一个date之外，还有其他三个参数，所以我选择将传入的第二个参数改成一个json：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="keyword">new</span> Calendar(<span class="string">'calendar'</span>,&#123;</span><br><span class="line">            <span class="string">'date'</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="comment">//创建日历的基本日期</span></span><br><span class="line">            <span class="string">'info'</span>: &#123; </span><br><span class="line">                <span class="comment">//日期的信息</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'callback'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">node,date</span>) </span>&#123; </span><br><span class="line">                    <span class="comment">//日历点击事件,在点击时会将被点击的元素，和日期对象传入该function；</span></span><br><span class="line">                &#125;,</span><br><span class="line">            <span class="string">'scense'</span>: <span class="string">'set'</span> <span class="comment">//使用场景</span></span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<p>然后在插件中将参数储存为变量，供后续使用：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.date = options.date;</span><br><span class="line"><span class="keyword">this</span>.dateInfo = options.info ? options.info : &#123;&#125;;</span><br><span class="line"><span class="keyword">this</span>.scense = options.scense ? options.scense : <span class="string">'get'</span>;</span><br><span class="line"><span class="keyword">this</span>.callback = options.callback ? options.callback : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">this</span>.activeDate = <span class="keyword">new</span> <span class="built_in">Date</span>(); <span class="comment">//最后被点击的日期，后续需要用到，所以先初始化了</span></span><br></pre></td></tr></table></figure></p>
<h1 id="将传入的信息展示在日历上"><a href="#将传入的信息展示在日历上" class="headerlink" title="将传入的信息展示在日历上"></a>将传入的信息展示在日历上</h1><p>首先为了日历信息能够能日期匹配，所以得设计一套数据结构，我为了方便存取，使用了如下的数据结构：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">'date20160706'</span>:&#123;<span class="string">'价格'</span>: <span class="number">100</span>, <span class="string">'数量'</span>: <span class="number">100</span>&#125;,</span><br><span class="line">    <span class="string">'date20160806'</span>:&#123;<span class="string">'价格'</span>: <span class="number">100</span>, <span class="string">'数量'</span>: <span class="number">100</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>其中id是根据日期生成的，可以保证其唯一性，具体方法为date+年月日：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成一个日期id，用于存取日期信息；</span></span><br><span class="line">Calendar.prototype._id = <span class="function"><span class="keyword">function</span>(<span class="params">date</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = date.getFullYear();</span><br><span class="line">    <span class="keyword">var</span> m = date.getMonth() + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> d = date.getDate();</span><br><span class="line">    m = m &lt; <span class="number">10</span> ? <span class="string">'0'</span> + m : m;</span><br><span class="line">    d = d &lt; <span class="number">10</span> ? <span class="string">'0'</span> + d : d;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'date'</span> + y + m + d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后在生成日历元素的时候，如果发现有当天的日历信息，那么就将其展示在元素。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> id = <span class="keyword">this</span>._id(monthArr.date[i])</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.dateInfo[id]) &#123;</span><br><span class="line">        innerHTML +=  <span class="string">'('</span> + <span class="keyword">this</span>.dateInfo[id][<span class="string">'价格'</span>] + <span class="string">')'</span>;<span class="comment">//将当天价格展示出来</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="添加一个输入的模态框并将输入的信息保存进日历信息"><a href="#添加一个输入的模态框并将输入的信息保存进日历信息" class="headerlink" title="添加一个输入的模态框并将输入的信息保存进日历信息"></a>添加一个输入的模态框并将输入的信息保存进日历信息</h1><p>当模式为后台设置时，需要设置每一天的日历信息，所以当点击日期时，模态框显示，当输入完确定之后，将信息存起来并隐藏模态框，点击取消时将模态框隐藏，考虑到可能需要输入很多不同的字段，所以在模态框中设置了两个input，分别对应当日信息的key和value，方便以后扩展。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Calendar.prototype._createInputModal = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> modalDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);<span class="comment">//创建模态框div</span></span><br><span class="line">    modalDiv.id = <span class="string">'calemdar-input-modal'</span>;</span><br><span class="line">    modalDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">    modalDiv.style.zIndex = <span class="number">999</span>;</span><br><span class="line">    modalDiv.style.width = <span class="string">'150px'</span>;</span><br><span class="line">    modalDiv.style.height = <span class="string">'100px'</span>;</span><br><span class="line">    modalDiv.style.position = <span class="string">'absolute'</span>;</span><br><span class="line">    modalDiv.style.right = <span class="string">'-155px'</span>;</span><br><span class="line">    <span class="keyword">var</span> keyInput = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span><br><span class="line">    keyInput.id = <span class="string">'key-input'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加输入框和按钮</span></span><br><span class="line">    modalDiv.innerHTML = <span class="string">'key：&lt;input type="text" id="calendar-key-input"/&gt;&lt;br/&gt;value：&lt;input type="text" id="calendar-value-input" /&gt;&lt;br/&gt;&lt;/br&gt;&lt;button id="calendar-sure-btn"&gt;确定&lt;/button&gt;&amp;nbsp&amp;nbsp&lt;button id="calendar-cancel-btn"&gt;取消&lt;/button&gt;'</span>;</span><br><span class="line">    <span class="keyword">this</span>.div.appendChild(modalDiv);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为确定按钮添加事件</span></span><br><span class="line">    <span class="keyword">var</span> keyInput = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-key-input'</span>);</span><br><span class="line">    <span class="keyword">var</span> valInput = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-value-input'</span>);</span><br><span class="line">    <span class="keyword">var</span> surebtn = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-sure-btn'</span>);</span><br><span class="line">    surebtn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> key = keyInput.value;</span><br><span class="line">        <span class="keyword">var</span> val = valInput.value;</span><br><span class="line">        <span class="keyword">if</span>(key != <span class="string">''</span> &amp;&amp; val != <span class="string">''</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> id = _that._id(_that.activeDate);</span><br><span class="line">            <span class="keyword">if</span>(_that.dateInfo.id) &#123;</span><br><span class="line">                _that.dateInfo.id[key] = val;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                _that.dateInfo[id] = &#123;&#125;;</span><br><span class="line">                _that.dateInfo[id][key] = val;</span><br><span class="line">            &#125;</span><br><span class="line">            _that[<span class="string">'showUI'</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;); <span class="comment">//重绘当前日历</span></span><br><span class="line">            modalDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">            keyInput.value = <span class="string">''</span>;</span><br><span class="line">            valInput.value = <span class="string">''</span>;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//为cancel按钮添加事件</span></span><br><span class="line">    <span class="keyword">var</span> cancelbtn = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-cancel-btn'</span>);</span><br><span class="line">    cancelbtn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        modalDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">        keyInput.value = <span class="string">''</span>;</span><br><span class="line">        valInput.value = <span class="string">''</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="增加获取日历信息的函数"><a href="#增加获取日历信息的函数" class="headerlink" title="增加获取日历信息的函数"></a>增加获取日历信息的函数</h1><p>在设置完了之后，为了方便将数据存入本地存储或者传入后端数据库，所以需要获取到最新的日历信息：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Calendar.prototype._getDateInfo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.dateInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>至此，一个可以供酒店预订的日历插件基本上已经完成了，还需要做得事情有调整UI，以适应信息的展示，界面也更漂亮一些，后续可能会将其改为jquery版本，或者使用vuejs来做一个备忘录的单页应用吧。<br>以下是完整的测试代码：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span><br><span class="line">        .actived-cell  &#123;</span><br><span class="line">            background-color: blue;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line"><span class="keyword">var</span> Calendar = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> Calendar = <span class="function"><span class="keyword">function</span>(<span class="params">div, options</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.div = <span class="built_in">document</span>.getElementById(div);</span><br><span class="line">        <span class="keyword">var</span> options = options</span><br><span class="line">        <span class="keyword">var</span> w = <span class="keyword">this</span>.div.style.width || <span class="number">390</span>;</span><br><span class="line">        <span class="keyword">var</span> h = <span class="keyword">this</span>.div.style.height || (<span class="number">300</span> - <span class="number">30</span>);</span><br><span class="line">        <span class="keyword">this</span>.width = <span class="built_in">parseInt</span>(w) &gt;= <span class="number">360</span> ? w : <span class="number">360</span>; </span><br><span class="line">        <span class="keyword">this</span>.height = <span class="built_in">parseInt</span>(h) &gt;= <span class="number">180</span> ? h : <span class="number">180</span>;</span><br><span class="line">        <span class="keyword">this</span>.date = options.date;</span><br><span class="line">        <span class="keyword">this</span>.dateInfo = options.info ? options.info : &#123;&#125;;</span><br><span class="line">        <span class="keyword">this</span>.scense = options.scense ? options.scense : <span class="string">'get'</span>;</span><br><span class="line">        <span class="keyword">this</span>.callback = options.callback ? options.callback : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">        <span class="keyword">this</span>.activeDate = <span class="keyword">new</span> <span class="built_in">Date</span>(); <span class="comment">//最后被点击的日期，后续需要用到，所以先初始化了 </span></span><br><span class="line">        <span class="keyword">this</span>.div.style.width = <span class="keyword">this</span>.width + <span class="string">'px'</span>; <span class="comment">//按默认值设置回去</span></span><br><span class="line">        <span class="keyword">this</span>.div.style.height = <span class="keyword">this</span>.height + <span class="string">'px'</span>;<span class="comment">//按默认值设置回去</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Calendar.week = [<span class="string">'一'</span>, <span class="string">'二'</span>,<span class="string">'三'</span>, <span class="string">'四'</span>,<span class="string">'五'</span>, <span class="string">'六'</span>, <span class="string">'日'</span>];</span><br><span class="line"></span><br><span class="line">    Calendar.prototype[<span class="string">'showUI'</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> exist = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_celldom_0'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!!exist)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> e = <span class="number">0</span>; e &lt; <span class="number">42</span>; e++)&#123;</span><br><span class="line">                <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_celldom_'</span> + e);</span><br><span class="line">                node.onclick = <span class="literal">null</span>; <span class="comment">//移除事件处理程序</span></span><br><span class="line">                <span class="keyword">this</span>.div.removeChild(node);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> width = <span class="keyword">this</span>.width,</span><br><span class="line">            height = <span class="keyword">this</span>.height,</span><br><span class="line">            cell = &#123;width: (<span class="built_in">parseInt</span>(width) - <span class="number">20</span>)/<span class="number">7</span>, height: (<span class="built_in">parseInt</span>(height) <span class="number">-30</span> - <span class="number">20</span>)/<span class="number">6</span>&#125;,</span><br><span class="line">            monthArr = <span class="keyword">this</span>._monthPanel(<span class="keyword">this</span>.date);</span><br><span class="line">        <span class="keyword">this</span>.div.style.paddingLeft = <span class="string">'8px'</span>; </span><br><span class="line">        <span class="keyword">this</span>.div.style.border = <span class="string">'2px solid #57ABFF'</span>;</span><br><span class="line">        <span class="keyword">this</span>.div.style.cursor = <span class="string">'default'</span>;</span><br><span class="line">        <span class="keyword">this</span>.div.style.fontFamily = <span class="string">'微软雅黑'</span>;</span><br><span class="line">        <span class="keyword">this</span>._addHeader();</span><br><span class="line">        <span class="keyword">this</span>._addWeekday();</span><br><span class="line">        <span class="keyword">this</span>._createInputModal();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">var</span> cellDOM = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            cellDOM.style.width = cell.width + <span class="string">'px'</span>;</span><br><span class="line">            cellDOM.style.height = cell.height + <span class="string">'px'</span>;</span><br><span class="line">            cellDOM.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">            cellDOM.style.cssFloat = <span class="string">'left'</span>;</span><br><span class="line">            cellDOM.style.cursor = <span class="string">'pointer'</span>;</span><br><span class="line">            cellDOM.style.textAlign = <span class="string">'center'</span>;</span><br><span class="line">            cellDOM.id = <span class="string">'vczero_celldom_'</span> + i;</span><br><span class="line">            cellDOM.style.lineHeight = cell.height + <span class="string">'px'</span>;</span><br><span class="line">            cellDOM.setAttribute(<span class="string">'date'</span>,monthArr.date[i]); <span class="comment">//设置日期对象到DOM属性date上</span></span><br><span class="line">            <span class="keyword">var</span> innerHTML = monthArr.date[i].getDate();</span><br><span class="line">            <span class="keyword">var</span> id = <span class="keyword">this</span>._id(monthArr.date[i])</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.dateInfo[id]) &#123;</span><br><span class="line">                    innerHTML +=  <span class="string">'('</span> + <span class="keyword">this</span>.dateInfo[id][<span class="string">'价格'</span>] + <span class="string">')'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cellDOM.innerHTML = innerHTML;</span><br><span class="line">            <span class="comment">//去掉最后一行横线</span></span><br><span class="line">            <span class="keyword">if</span>(i &lt; <span class="number">35</span>)&#123; </span><br><span class="line">                cellDOM.style.borderBottom = <span class="string">'1px solid #C8CACC'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(i &lt; monthArr.preLen || i &gt;= monthArr.currentLen + monthArr.preLen)&#123;</span><br><span class="line">                cellDOM.style.color = <span class="string">'#BFBFBF'</span>;</span><br><span class="line">                cellDOM.classList.add(<span class="string">'disabled'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.div.appendChild(cellDOM);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用父元素事件委托</span></span><br><span class="line">        <span class="keyword">var</span> _that = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">var</span> inputModal = <span class="built_in">document</span>.getElementById(<span class="string">'calemdar-input-modal'</span>);</span><br><span class="line">        <span class="keyword">this</span>.div.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> node = e.target;</span><br><span class="line">            <span class="keyword">var</span> nodeClass = node.classList;</span><br><span class="line">            <span class="keyword">if</span>(node.id.indexOf(<span class="string">'vczero_celldom_'</span>) &gt; <span class="number">-1</span> &amp;&amp; !nodeClass.contains(<span class="string">'disabled'</span>))&#123;</span><br><span class="line">                <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(node.getAttribute(<span class="string">'date'</span>));</span><br><span class="line">                _that.activeDate = date;</span><br><span class="line">                <span class="keyword">if</span>(_that.scense == <span class="string">'set'</span>) &#123;</span><br><span class="line">                    inputModal.style.display  = <span class="string">'block'</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(_that.scense == <span class="string">'get'</span>) &#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                _that.callback(node, date);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Calendar.prototype._addHeader = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> exist = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_datediv'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!!exist)&#123;</span><br><span class="line">            exist.onclick = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.div.removeChild(exist);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> header = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        header.style.height = <span class="string">'22px'</span>;</span><br><span class="line">        header.style.width = <span class="keyword">this</span>.div.style.width || <span class="string">'800px'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//包含左 时间 右的大DIV</span></span><br><span class="line">        <span class="keyword">var</span> dateDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        dateDiv.style.width = <span class="string">'200px'</span>;</span><br><span class="line">        dateDiv.style.height = <span class="string">'22px'</span>;</span><br><span class="line">        dateDiv.style.margin = <span class="string">'0 auto'</span>;</span><br><span class="line">        dateDiv.style.textAlign = <span class="string">'center'</span>;</span><br><span class="line">        dateDiv.style.fontWeight = <span class="string">'bold'</span>;</span><br><span class="line">        dateDiv.style.padding = <span class="string">'10px'</span>;</span><br><span class="line">        dateDiv.id = <span class="string">'vczero_datediv'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&lt; DIV</span></span><br><span class="line">        <span class="keyword">var</span> leftDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        leftDiv.innerHTML = <span class="string">'&lt;'</span>;</span><br><span class="line">        leftDiv.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">        leftDiv.style.float = <span class="string">'left'</span>;</span><br><span class="line">        leftDiv.style.width = <span class="string">'50px'</span>;</span><br><span class="line">        leftDiv.style.cursor = <span class="string">'pointer'</span>;</span><br><span class="line">        leftDiv.style.color = <span class="string">'#C5BFBF'</span>;</span><br><span class="line">        <span class="keyword">var</span> _that = <span class="keyword">this</span>; <span class="comment">//获取到this对象</span></span><br><span class="line">        leftDiv.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> year = <span class="built_in">parseInt</span>(_that.date.getFullYear()),</span><br><span class="line">                month = <span class="built_in">parseInt</span>(_that.date.getMonth());</span><br><span class="line">            <span class="keyword">if</span>(month === <span class="number">0</span>)&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year - <span class="number">1</span>, <span class="number">11</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            _that[<span class="string">'showUI'</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&gt; DIV</span></span><br><span class="line">        <span class="keyword">var</span> rightDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        rightDiv.innerHTML = <span class="string">'&gt;'</span>;</span><br><span class="line">        rightDiv.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">        rightDiv.style.float = <span class="string">'left'</span>;</span><br><span class="line">        rightDiv.style.width = <span class="string">'50px'</span>;</span><br><span class="line">        rightDiv.style.cursor = <span class="string">'pointer'</span>;</span><br><span class="line">        rightDiv.style.color = <span class="string">'#C5BFBF'</span>;</span><br><span class="line">        rightDiv.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> year = <span class="built_in">parseInt</span>(_that.date.getFullYear()),</span><br><span class="line">                month = <span class="built_in">parseInt</span>(_that.date.getMonth());</span><br><span class="line">            <span class="keyword">if</span>(month === <span class="number">11</span>)&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year + <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                _that.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            _that[<span class="string">'showUI'</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//显示月份的DIV</span></span><br><span class="line">        <span class="keyword">var</span> timeDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        timeDiv.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">        timeDiv.style.float = <span class="string">'left'</span>;</span><br><span class="line">        timeDiv.style.width = <span class="string">'100px'</span>;</span><br><span class="line">        timeDiv.innerHTML = <span class="keyword">this</span>.date.getFullYear() + <span class="string">'年'</span> + (<span class="keyword">this</span>.date.getMonth() + <span class="number">1</span>) + <span class="string">'月'</span>;</span><br><span class="line"></span><br><span class="line">        dateDiv.appendChild(leftDiv);</span><br><span class="line">        dateDiv.appendChild(timeDiv);</span><br><span class="line">        dateDiv.appendChild(rightDiv);</span><br><span class="line">        <span class="keyword">this</span>.div.appendChild(dateDiv);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//增加星期</span></span><br><span class="line">    Calendar.prototype._addWeekday = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> exist = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_week_0'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!!exist)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'vczero_week_'</span> + i);</span><br><span class="line">                node.onclick = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.div.removeChild(node);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; <span class="number">7</span>; n++)&#123;</span><br><span class="line">            <span class="keyword">var</span> weekday = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            weekday.style.width = (<span class="built_in">parseInt</span>(<span class="keyword">this</span>.width) - <span class="number">20</span>)/<span class="number">7</span> + <span class="string">'px'</span>;</span><br><span class="line">            weekday.style.height = <span class="string">'20px'</span>;</span><br><span class="line">            weekday.style.display = <span class="string">'inline-block'</span>;</span><br><span class="line">            weekday.style.float = <span class="string">'left'</span>;</span><br><span class="line">            weekday.style.color = <span class="string">'#BFBFBF'</span>;</span><br><span class="line">            weekday.style.fontWeight = <span class="string">'bold'</span>;</span><br><span class="line">            weekday.style.textAlign = <span class="string">'center'</span>;</span><br><span class="line">            weekday.id = <span class="string">'vczero_week_'</span> + n;</span><br><span class="line">            weekday.innerHTML = Calendar.week[n];</span><br><span class="line">            <span class="keyword">this</span>.div.appendChild(weekday);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Calendar.prototype._monthPanel = <span class="function"><span class="keyword">function</span>(<span class="params">date</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//如果传递了Date对象，则按Date对象进行计算月份面板</span></span><br><span class="line">        <span class="comment">//否则，按照当前月份计算面板</span></span><br><span class="line">        <span class="keyword">var</span> myDate = date || <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">            year = myDate.getFullYear(),</span><br><span class="line">            month = myDate.getMonth(),</span><br><span class="line">            day = myDate.getDate(),</span><br><span class="line">            week = myDate.getDay(),</span><br><span class="line">            currentDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, <span class="number">0</span>).getDate(),</span><br><span class="line">            preDays = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate(),</span><br><span class="line">            firstDay = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">1</span>),</span><br><span class="line">            firstCell = firstDay.getDay() === <span class="number">0</span> ? <span class="number">6</span> : firstDay.getDay() - <span class="number">1</span>,</span><br><span class="line">            bottomCell =  <span class="number">42</span> - currentDays - firstCell;</span><br><span class="line">        <span class="comment">//前一个月该显示多少天</span></span><br><span class="line">        <span class="keyword">var</span> preMonth = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> p = firstCell; p &gt; <span class="number">0</span>; p--)&#123;</span><br><span class="line">            preMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, preDays - p + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> len = preMonth.length;</span><br><span class="line">        <span class="comment">//本月</span></span><br><span class="line">        <span class="keyword">var</span> currentMonth = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; currentDays; c++)&#123;</span><br><span class="line">            currentMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month, c + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//下一个月</span></span><br><span class="line">        <span class="keyword">var</span> nextMonth = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; bottomCell; n++)&#123;</span><br><span class="line">            nextMonth.push(<span class="keyword">new</span> <span class="built_in">Date</span>(year, month + <span class="number">1</span>, n + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        preMonth = preMonth.concat(currentMonth, nextMonth);</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            date: preMonth,</span><br><span class="line">            preLen: len,</span><br><span class="line">            currentLen: currentMonth.length</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    Calendar.prototype._createInputModal = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> _that = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">var</span> modalDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">        modalDiv.id = <span class="string">'calemdar-input-modal'</span>;</span><br><span class="line">        modalDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">        modalDiv.style.zIndex = <span class="number">999</span>;</span><br><span class="line">        modalDiv.style.width = <span class="string">'150px'</span>;</span><br><span class="line">        modalDiv.style.height = <span class="string">'100px'</span>;</span><br><span class="line">        modalDiv.style.position = <span class="string">'absolute'</span>;</span><br><span class="line">        modalDiv.style.right = <span class="string">'-155px'</span>;</span><br><span class="line">        <span class="keyword">var</span> keyInput = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span><br><span class="line">        keyInput.id = <span class="string">'key-input'</span>;</span><br><span class="line"></span><br><span class="line">        modalDiv.innerHTML = <span class="string">'key：&lt;input type="text" id="calendar-key-input"/&gt;&lt;br/&gt;value：&lt;input type="text" id="calendar-value-input" /&gt;&lt;br/&gt;&lt;/br&gt;&lt;button id="calendar-sure-btn"&gt;确定&lt;/button&gt;&amp;nbsp&amp;nbsp&lt;button id="calendar-cancel-btn"&gt;取消&lt;/button&gt;'</span>;</span><br><span class="line">        <span class="keyword">this</span>.div.appendChild(modalDiv);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//为确定按钮添加事件</span></span><br><span class="line">        <span class="keyword">var</span> keyInput = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-key-input'</span>);</span><br><span class="line">        <span class="keyword">var</span> valInput = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-value-input'</span>);</span><br><span class="line">        <span class="keyword">var</span> surebtn = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-sure-btn'</span>);</span><br><span class="line">        surebtn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> key = keyInput.value;</span><br><span class="line">            <span class="keyword">var</span> val = valInput.value;</span><br><span class="line">            <span class="keyword">if</span>(key != <span class="string">''</span> &amp;&amp; val != <span class="string">''</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> id = _that._id(_that.activeDate);</span><br><span class="line">                <span class="keyword">if</span>(_that.dateInfo.id) &#123;</span><br><span class="line">                    _that.dateInfo.id[key] = val;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    _that.dateInfo[id] = &#123;&#125;;</span><br><span class="line">                    _that.dateInfo[id][key] = val;</span><br><span class="line">                &#125;</span><br><span class="line">                _that[<span class="string">'showUI'</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;); <span class="comment">//重绘当前日历</span></span><br><span class="line">                modalDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">                keyInput.value = <span class="string">''</span>;</span><br><span class="line">                valInput.value = <span class="string">''</span>;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//为cancel按钮添加事件</span></span><br><span class="line">        <span class="keyword">var</span> cancelbtn = <span class="built_in">document</span>.getElementById(<span class="string">'calendar-cancel-btn'</span>);</span><br><span class="line">        cancelbtn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            modalDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">            keyInput.value = <span class="string">''</span>;</span><br><span class="line">            valInput.value = <span class="string">''</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//生成一个日期id，用于存取日期信息；</span></span><br><span class="line">    Calendar.prototype._id = <span class="function"><span class="keyword">function</span>(<span class="params">date</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> y = date.getFullYear();</span><br><span class="line">        <span class="keyword">var</span> m = date.getMonth() + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">var</span> d = date.getDate();</span><br><span class="line">        m = m &lt; <span class="number">10</span> ? <span class="string">'0'</span> + m : m;</span><br><span class="line">        d = d &lt; <span class="number">10</span> ? <span class="string">'0'</span> + d : d;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'date'</span> + y + m + d;</span><br><span class="line">    &#125;</span><br><span class="line">    Calendar.prototype._getDateInfo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.dateInfo;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Calendar;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">showCalendar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> c = <span class="keyword">new</span> Calendar(<span class="string">'calendar'</span>,&#123;</span><br><span class="line">            <span class="string">'date'</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="comment">//创建日历的基本日期</span></span><br><span class="line">            <span class="string">'info'</span>: &#123;  <span class="comment">//日期的信息</span></span><br><span class="line">                <span class="string">'date20160706'</span>:&#123;<span class="string">'价格'</span>: <span class="number">100</span>, <span class="string">'数量'</span>: <span class="number">100</span>&#125;,</span><br><span class="line">                <span class="string">'date20160806'</span>:&#123;<span class="string">'价格'</span>: <span class="number">100</span>, <span class="string">'数量'</span>: <span class="number">100</span>&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'callback'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">node,date</span>) </span>&#123; <span class="comment">//日历点击事件</span></span><br><span class="line">                    <span class="keyword">var</span> nodeClass = node.classList;</span><br><span class="line">                    <span class="keyword">var</span> y = date.getFullYear();</span><br><span class="line">                    <span class="keyword">var</span> m = date.getMonth() + <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">var</span> d = date.getDate();</span><br><span class="line">                    m = m &lt; <span class="number">10</span> ? <span class="string">'0'</span> + m : m;</span><br><span class="line">                    d = d &lt; <span class="number">10</span> ? <span class="string">'0'</span> + d : d;</span><br><span class="line">                    <span class="keyword">var</span> id =  <span class="string">'date'</span> + y + m + d;</span><br><span class="line">                    <span class="built_in">console</span>.log(id)</span><br><span class="line">                    <span class="built_in">console</span>.log(nodeClass)</span><br><span class="line">                    <span class="keyword">if</span>(nodeClass.contains(<span class="string">'actived-cell'</span>)) &#123;</span><br><span class="line">                        nodeClass.remove(<span class="string">'actived-cell'</span>)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        nodeClass.add(<span class="string">'actived-cell'</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">            <span class="string">'scense'</span>: <span class="string">'set'</span> <span class="comment">//使用场景</span></span><br><span class="line">        &#125;);</span><br><span class="line">        c.getDate = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            alert(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">this</span>.getAttribute(<span class="string">'date'</span>)).toLocaleString());</span><br><span class="line">        &#125;;</span><br><span class="line">       c.showUI();</span><br><span class="line">   &#125;</span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"showCalendar()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"calendar"</span> <span class="attr">style</span>=<span class="string">"width:600px; height:450px;border:1px solid red;position: relative;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[nodejs实现替换项目内所有文件指定字段]]></title>
      <url>http://yoursite.com/2016/07/07/nodejs%E5%AE%9E%E7%8E%B0%E6%9B%BF%E6%8D%A2%E9%A1%B9%E7%9B%AE%E5%86%85%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5/</url>
      <content type="html"><![CDATA[<p>由于项目开发中项目的名称需要改变，需要将页面中出现旧名称的地方都替换成新的名称，包括一些提示语也要全部修改，想到现在需求经常改变，指不定哪天上头心血来潮就又改一次，而修改的工作肯定又落到我的头上，所以想到了写个脚本偷偷懒，提高一下效率。最近在学习nodejs，也正好熟悉一下fsapi。<br><a id="more"></a></p>
<h1 id="批量替换文件中的内容"><a href="#批量替换文件中的内容" class="headerlink" title="批量替换文件中的内容"></a>批量替换文件中的内容</h1><p>要开始一件从来没做过的事情，当然是先google一下。幸运的是找到了一个批量修改文件内URL的，正合我意，原始代买如下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">arguments</span> = process.argv.slice(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> command = <span class="built_in">arguments</span>[<span class="number">0</span>]+<span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> newReplaceUrl = <span class="built_in">arguments</span>[<span class="number">1</span>]+<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(command != ‘-<span class="keyword">new</span>‘ || newReplaceUrl == <span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="keyword">throw</span> ‘please input your <span class="keyword">new</span> url. Eg: node rurl.js -<span class="keyword">new</span> https:<span class="comment">//www.g.cn/‘;</span></span><br><span class="line">&#125;</span><br><span class="line">       </span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(‘fs‘);</span><br><span class="line"><span class="keyword">var</span> files = [<span class="string">"bank.css"</span>, <span class="string">"wallet.css"</span>];</span><br><span class="line"><span class="keyword">var</span> URL_REG = <span class="regexp">/url\(.*?;/g</span>;</span><br><span class="line"><span class="keyword">var</span> PIC_REG = <span class="regexp">/url\(.*?(?=[A-Za-z_\-0-9]*(\.png|\.jpg))/</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;files.length;i++)&#123;</span><br><span class="line">    <span class="keyword">var</span> file = files[i];</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">_file</span>)</span>&#123;</span><br><span class="line">        fs.readFile(_file,<span class="function"><span class="keyword">function</span> (<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">            data = data + <span class="string">""</span>;</span><br><span class="line">            data = data.replace(URL_REG,<span class="function"><span class="keyword">function</span> (<span class="params">word</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(word.indexOf(<span class="string">"important"</span>) != <span class="number">-1</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> word;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">var</span> url = <span class="string">"url("</span> + newReplaceUrl;</span><br><span class="line">                    <span class="keyword">return</span> word.replace(PIC_REG, url);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            fs.writeFile(_file, data, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(err)&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">"error!"</span> + _file);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">"success!"</span> + _file);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)(file)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>分析了一下上面这段代码，其主要功能就是从命令行接受一个命令和一个新的url，然后打开files里面的每一个文件进行替换，而我的需求是从命令行接受两个参数，一个是旧的字符串，一个是新的字符串，然后将旧的字符串替换成新的。修改后代码为:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">var <span class="built_in">arguments</span> = process.argv.slice(<span class="number">2</span>); <span class="comment">//从命令行获取需要替换的字段和新字段</span></span><br><span class="line"><span class="keyword">var</span> oldstr = <span class="built_in">arguments</span>[<span class="number">0</span>]+<span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> newstr = <span class="built_in">arguments</span>[<span class="number">1</span>]+<span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(oldstr, <span class="string">'g'</span>); <span class="comment">//要使用变量创建正则必须使用new RegEXP()，用字面量创建不行</span></span><br><span class="line">...</span><br><span class="line">data = data.replace(reg, newstr); <span class="comment">//要全局替换的话replace里面必须使用正则，否则会只替换第一个匹配的字符串</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>这样替换函数就修改完了，保存为replace.js。<br>替换函数写完之后，我新建了一个测试文件将文件路径写到replace里面，然后运行:</p>
<blockquote>
<p>node repalce.js 测试替换 测试成功</p>
</blockquote>
<p>打开测试文件发现里面测试替换的地方都变成测试成功了，说明替换函数没有问题。</p>
<h1 id="获取所有需要修改的路径并缓存起来"><a href="#获取所有需要修改的路径并缓存起来" class="headerlink" title="获取所有需要修改的路径并缓存起来"></a>获取所有需要修改的路径并缓存起来</h1><p>虽然替换函数写完之后，还面临着一个问题就是整个项目有几十个页面，手动添加的话肯定是不能满足我的，所以我又google了一下，nodejs如何遍历目录下所有文件，很快就找到前人写好的函数了。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>),  </span><br><span class="line">    fileList = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params">path</span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> dirList = fs.readdirSync(path);</span><br><span class="line">    dirList.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(fs.statSync(path + <span class="string">'/'</span> + item).isDirectory())&#123;</span><br><span class="line">            walk(path + <span class="string">'/'</span> + item);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            fileList.push(path + <span class="string">'/'</span> + item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">walk(<span class="string">'/dirName'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(fileList);</span><br></pre></td></tr></table></figure></p>
<p>恩，很简单的一个递归遍历，而且正好已经把路径存好了，但是运行函数需要手动修改根目录，查看了一下nodejs的api之后，发现获取当前路径的方法如下。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path = fs.realpathSync(<span class="string">'.'</span>);</span><br></pre></td></tr></table></figure></p>
<p>至此文件路径有了，替换函数有了，基本上已经完成了。但是我只需要找到特定后缀的文件进行修改，所以在遍历文件的时候加了一个判断，当后缀为.psp的时候才将路径缓存起来。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="regexp">/\.psp$/</span>.test(item)) &#123; <span class="comment">//将所有.psp后缀的文件路径保存在fileList中</span></span><br><span class="line">    fileList.push(path + <span class="string">'/'</span> + item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>将replace.js放到项目的根目录下，然后运行</p>
<blockquote>
<p>node replace.js 老字符串  新字符串</p>
</blockquote>
<p>替换成功。以后终于不用再一个一个页面去改了。<br>完整版代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> current_path = fs.realpathSync(<span class="string">'.'</span>); <span class="comment">//获取当前路径 </span></span><br><span class="line"><span class="keyword">var</span> fileList = [];</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">arguments</span> = process.argv.slice(<span class="number">2</span>); <span class="comment">//从命令行获取需要替换的字段和新字段</span></span><br><span class="line"><span class="keyword">var</span> oldstr = <span class="built_in">arguments</span>[<span class="number">0</span>]+<span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> newstr = <span class="built_in">arguments</span>[<span class="number">1</span>]+<span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(oldstr, <span class="string">'g'</span>); <span class="comment">//新建替换正则</span></span><br><span class="line"><span class="built_in">console</span>.log(oldstr + <span class="string">'---&gt;'</span> + newstr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(oldstr == <span class="literal">null</span> || newstr == <span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="string">'please input your oldstr and newstr: node replcae.js oldstr newstr'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获取当前文件夹内所有指定格式的文件的绝对路径并缓存起来</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params">path</span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> dirList = fs.readdirSync(path);</span><br><span class="line">    dirList.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(fs.statSync(path + <span class="string">'/'</span> + item).isDirectory())&#123;</span><br><span class="line">            walk(path + <span class="string">'/'</span> + item);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="regexp">/\.psp$/</span>.test(item)) &#123; <span class="comment">//将所有.psp后缀的文件路径保存在fileList中</span></span><br><span class="line">                fileList.push(path + <span class="string">'/'</span> + item);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">walk(current_path);</span><br><span class="line"><span class="built_in">console</span>.log(fileList);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> files = fileList;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;files.length;i++)&#123;</span><br><span class="line">    <span class="keyword">var</span> file = files[i];</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">_file</span>)</span>&#123;</span><br><span class="line">        fs.readFile(_file,<span class="function"><span class="keyword">function</span> (<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">            data = data + <span class="string">""</span>;</span><br><span class="line">            data = data.replace(reg, newstr);</span><br><span class="line">            </span><br><span class="line">            fs.writeFile(_file, data, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(err)&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">"error!"</span> + _file);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(_file + <span class="string">'   ok!'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)(file)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="总结一下"><a href="#总结一下" class="headerlink" title="总结一下"></a>总结一下</h1><p>虽然功能是实现了，但是迫于时间，并没有深入的研究里面的逻辑，有时间还是应该重新研究一下，好好学习一下API,熟练掌握node，提高生产效率。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[使用webpack打包时常用的一些插件]]></title>
      <url>http://yoursite.com/2016/06/29/%E4%BD%BF%E7%94%A8webpack%E6%89%93%E5%8C%85%E6%97%B6%E5%B8%B8%E7%94%A8%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8F%92%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>虽然之前已经看过很多webpack的教程，也动手写过一些小的测试用例来学习，但一直没有进行系统的记录，也没有对写过的东西进行系统化的整理，趁现在比较闲，开始整理一下webpack使用时一些通用的模块，同时构建好一个通用的开发目录，为以后开始新的项目的时候能够快速的进入开发，不必浪费时间在目录构建上面。</p>
<a id="more"></a>
<h1 id="初始化项目目录结构"><a href="#初始化项目目录结构" class="headerlink" title="初始化项目目录结构"></a>初始化项目目录结构</h1><p>新建项目主文件夹然后用git对项目进行管理</p>
<blockquote>
<p>mkdir  project<br>git init</p>
</blockquote>
<h1 id="webpack的安装与使用"><a href="#webpack的安装与使用" class="headerlink" title="webpack的安装与使用"></a>webpack的安装与使用</h1><p>电脑早就已经安装好了node，所以只要 npm install 一下就好了</p>
<blockquote>
<p>npm install webpack -g</p>
</blockquote>
<p>然后初始化项目结构</p>
<blockquote>
<p>npm init</p>
</blockquote>
<p>在项目主目录中新建webpack.config.js,随便在网上找了一个完整的config示例，后续进行修改以满足自己的需求。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack 配置示例</span></span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> commonsPlugin = <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(<span class="string">'common.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//插件项</span></span><br><span class="line">    plugins: [commonsPlugin],</span><br><span class="line">    <span class="comment">//页面入口文件配置</span></span><br><span class="line">    entry: &#123;</span><br><span class="line">        index : <span class="string">'./src/js/page/index.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//入口文件输出配置</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        path: <span class="string">'dist/js/page'</span>,</span><br><span class="line">        filename: <span class="string">'[name].js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        <span class="comment">//加载器配置</span></span><br><span class="line">        loaders: [</span><br><span class="line">            &#123; test: <span class="regexp">/\.css$/</span>, loader: <span class="string">'style-loader!css-loader'</span> &#125;,</span><br><span class="line">            &#123; test: <span class="regexp">/\.js$/</span>, loader: <span class="string">'jsx-loader?harmony'</span> &#125;,</span><br><span class="line">            &#123; test: <span class="regexp">/\.scss$/</span>, loader: <span class="string">'style!css!sass?sourceMap'</span>&#125;,</span><br><span class="line">            &#123; test: <span class="regexp">/\.(png|jpg)$/</span>, loader: <span class="string">'url-loader?limit=8192'</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//其它解决方案配置</span></span><br><span class="line">    resolve: &#123;</span><br><span class="line">        root: <span class="string">'E:/github/flux-example/src'</span>, <span class="comment">//绝对路径</span></span><br><span class="line">        extensions: [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.scss'</span>],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            AppStore : <span class="string">'js/stores/AppStores.js'</span>,</span><br><span class="line">            ActionType : <span class="string">'js/actions/ActionType.js'</span>,</span><br><span class="line">            AppAction : <span class="string">'js/actions/AppAction.js'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol>
<li>plugins 是插件项，这里我们使用了一个 CommonsChunkPlugin 的插件，它用于提取多个入口文件的公共脚本部分，然后生成一个 common.js 来方便多页面之间进行复用。</li>
<li>entry 是页面入口文件配置，output 是对应输出项配置（即入口文件最终要生成什么名字的文件、存放到哪里）</li>
<li>module.loaders 是最关键的一块配置。它告知 webpack 每一种文件都需要使用什么加载器来处理</li>
<li>最后是 resolve 配置<h1 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h1><h1 id="配置html-webpack-plugin"><a href="#配置html-webpack-plugin" class="headerlink" title="配置html-webpack-plugin"></a>配置html-webpack-plugin</h1></li>
</ol>
<p>html-webpack-plugin可以自动快速的生成html文件，就不用每次还得手动重复的去建立html文件了。<br>安装</p>
<blockquote>
<p>npm install html-webpack-plugin –save-dev</p>
</blockquote>
<p>然后修改config</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlwebpackPlugin(&#123;</span><br><span class="line">      title: <span class="string">''</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="配置webpack-dev-server"><a href="#配置webpack-dev-server" class="headerlink" title="配置webpack-dev-server"></a>配置webpack-dev-server</h1><p>webpack-dev-server可以建立一个sever，监控文件的变化，实现页面自动刷新，所以开发的时候不需要手动刷新便可以看到改动的效果。<br>安装</p>
<blockquote>
<p>npm install webpack-dev-server –save-dev</p>
</blockquote>
<p>然后修改config进行配置<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> module.exports = &#123;</span><br><span class="line">  ....</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    historyApiFallback: true,</span><br><span class="line">    hot: true,</span><br><span class="line">    inline: true,</span><br><span class="line">    progress: true,</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后再package.json里面配置一下运行的命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;start&quot;: &quot;webpack-dev-server --hot --inline&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>在项目根目录下输入</p>
<blockquote>
<p>npm start</p>
</blockquote>
<p>就可以启动sever，在浏览器中打开localhost:8080就可以看到页面，接下来只要修改文件页面就会自动刷新了。</p>
<h1 id="配置loaders"><a href="#配置loaders" class="headerlink" title="配置loaders"></a>配置loaders</h1><h1 id="css-scss"><a href="#css-scss" class="headerlink" title="css,scss"></a>css,scss</h1><p>处理css需要两种loader，css-loader 和 style-loader，css-loader会遍历css文件，找到所有的url(…)并且处理。style-loader会把所有的样式插入页面的一个style tag中。.scss 文件使用 style-loader、css-loader 和 sass-loader 来编译处理。<br>安装</p>
<blockquote>
<p>npm install css-loader style-loader sass-loader –save-dev</p>
</blockquote>
<h1 id="es6和jsx"><a href="#es6和jsx" class="headerlink" title="es6和jsx"></a>es6和jsx</h1><p>es6的语法支持和jsx文件可以通过bable进行编译处理<br>安装</p>
<blockquote>
<p>npm install babel-loader babel-preset-es2015 –save-dev</p>
</blockquote>
<h1 id="处理图片和其他静态文件"><a href="#处理图片和其他静态文件" class="headerlink" title="处理图片和其他静态文件"></a>处理图片和其他静态文件</h1><p>url-loader可以处理静态资源，根据需求将图片自动转成base64编码的，可以减轻很多的网络请求。<br>安装</p>
<blockquote>
<p>npm install url-loader –save-dev</p>
</blockquote>
<p>最终config文件中的module.loader配置是这样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">    loaders: [</span><br><span class="line">            //.css 文件使用 style-loader 和 css-loader 来处理</span><br><span class="line">            &#123; test: /\.css$/, loader: &apos;style-loader!css-loader&apos; &#125;,</span><br><span class="line">            //.js 文件使用 jsx-loader 来编译处理</span><br><span class="line">            &#123; test: /\.jsx?$/, loader: &apos;babel&apos;,include: APP_PATH, query: &#123; presets: [&apos;es2015&apos;] &#125; &#125;,</span><br><span class="line">            //.scss 文件使用 style-loader、css-loader 和 sass-loader 来编译处理</span><br><span class="line">            &#123; test: /\.scss$/, loader: &apos;style!css!sass?sourceMap&apos;&#125;,</span><br><span class="line">            //图片文件使用 url-loader 来处理，小于8kb的直接转为base64</span><br><span class="line">            &#123; test: /\.(png|jpg)$/, loader: &apos;url-loader?limit=8192&apos;&#125;</span><br><span class="line">        ]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p>
<h1 id="独立打包css"><a href="#独立打包css" class="headerlink" title="独立打包css"></a>独立打包css</h1><p>希望项目的样式能不要被打包到脚本中，而是独立出来作为.css，然后在页面中以<link>标签引入。这时候可以使用 extract-text-webpack-plugin</p>
<blockquote>
<p>npm install extract-text-webpack-plugin –save-dev</p>
</blockquote>
<p>在config中设置一下插件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var webpack = require(&apos;webpack&apos;);</span><br><span class="line">    var commonsPlugin = new webpack.optimize.CommonsChunkPlugin(&apos;common.js&apos;);</span><br><span class="line">    var ExtractTextPlugin = require(&quot;extract-text-webpack-plugin&quot;);</span><br><span class="line"></span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        plugins: [commonsPlugin, new ExtractTextPlugin(&quot;[name].css&quot;)],</span><br><span class="line">        entry: &#123;</span><br><span class="line">        //...省略其它配置</span><br></pre></td></tr></table></figure></p>
<p>大致是完成了，接下来应该会学习一些插件的更多用法</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[第一篇文章]]></title>
      <url>http://yoursite.com/2016/06/27/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/</url>
      <content type="html"><![CDATA[<p><em>第一次想要搭建一个blog不知道是几年之前了，自己搞过服务器用webpy搭建过一个简易的，也在csdn开通过，但都只是三分钟热度，并没有在上面发表过什么东西，肚子里没几滴墨水，大学几年也浑浑噩噩，没学到什么东西。
</em>github也注册很久了，然而现在前端水平也只属于入门水平，并没有什么满意的项目推送到仓库。之前也有弄了一下gitpage，但是感觉并不方便，写博客的计划就又搁置了。知道最近发现hexo，而现在更换上班地点后到家比较早了，便又开始试了一下，作为一个前端，在发现页面主题和颜色可以自己编写之后又便根本停不下来了，折腾了半天之后，终于成了现在这个样子，虽然还需继续完善，但勉强也能看得下去了。<br>*毕业两年，作为前端工作也快满一年了，也逐渐开始深入学习，学习过程就在此记录吧。</p>
]]></content>
    </entry>
    
  
  
</search>
